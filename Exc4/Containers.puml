@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

' Участники
Person(Клиент, "Клиент", "Пожилой клиент, звонящий в кол-центр")
Person(СотрудникКолцентра, "Сотрудник кол-центра", "Работает в основном кол-центре для обработки звонков")
Person(СотрудникПартнера, "Сотрудник партнёрского кол-центра", "Работает в системе партнёрского кол-центра")

' Основные системы
System_Boundary(КолЦентр, "Система кол-центра") {
    Container(CallCenterApp, "Приложение кол-центра", "React.js + Spring Boot", "Обрабатывает звонки и предоставляет данные о ставках через API")
    ContainerDb(CallCenterDb, "База данных кол-центра", "PostgreSQL", "Хранение клиентских заявок и данных")
}

System_Boundary(ПартнерскаяСистема, "Партнёрская система") {
    Container(PartnerCallCenter, "Система партнёрского кол-центра", "SFTP", "Получение данных о ставках в виде файлов")
}

System_Boundary(СервисСтавок, "Сервис управления ставками") {
    Container(СтавкиAPI, "API ставок", "Spring Boot", "Предоставляет актуальные данные по ставкам")
    Container(СтавкиФайлы, "Генерация файлов ставок", "Python", "Получает данные через API и создаёт файлы ставок для партнёрского кол-центра")
    ContainerDb(СтавкиDb, "База данных ставок", "PostgreSQL", "Хранение кэшированных данных о ставках")
}

System_Boundary(ABS, "АБС") {
    Container(AbsLogic, "Логика АБС", "PL/SQL", "Обработка ставок и заявок")
    ContainerDb(AbsDb, "База данных АБС", "Oracle Database", "Хранение данных о депозитах")
}

' Взаимодействия клиента
Rel(Клиент, CallCenterApp, "Запрос данных о ставках")
Rel(Клиент, PartnerCallCenter, "Запрос данных о ставках")

' Взаимодействие с сотрудниками
Rel(СотрудникКолцентра, CallCenterApp, "Работа с системой для обработки звонков")
Rel(СотрудникПартнера, PartnerCallCenter, "Работа с системой для обработки звонков")

' Взаимодействие систем
Rel(CallCenterApp, СтавкиAPI, "Получение данных о ставках через API")
Rel(СтавкиAPI, AbsLogic, "Получение данных о ставках из АБС")
Rel(AbsLogic, AbsDb, "Чтение/запись данных ставок")
Rel(СтавкиAPI, СтавкиDb, "Кэширование ставок")
Rel(СтавкиФайлы, СтавкиAPI, "Запрос данных о ставках через API")
Rel(СтавкиФайлы, PartnerCallCenter, "Передача файлов через SFTP")
@enduml
